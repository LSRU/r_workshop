---
title: "R workshop"
author: "Aurélien Ginolhac"
date: "2nd June 2016"
output:
  ioslides_presentation:
    css: style.css
    logo: img/uni.png
    smaller: yes
---

```{r setup, include=FALSE}
library(dplyr)
knitr::opts_chunk$set(echo = TRUE)
```

## R workshop | Day 1 - beginner

## Why learn R? {.build}

- Free!
- Packages
- Community

<img src="img/r_community_450.png">


## Packages | as easy as `apt` and yes frequent updates


<div class="columns-2">
- CRAN, reliable many checks when submitting

![](img/install_packages_300.png)

- [GitHub](https://github.com/) using [devtools](https://github.com/hadley/devtools). Check [status](https://github.com/hadley/readr)

```{r, eval=FALSE}
# install.packages("devtools")
devtools::install_github("hadley/readr")
```

- [bioconductor](https://www.bioconductor.org/). Check [status](https://www.bioconductor.org/packages/release/bioc/html/limma.html)
```{r, eval=FALSE}
source("https://bioconductor.org/biocLite.R")
biocLite("limma")
```

![](img/install_console_200.png)

</div>


## More and more packages

![](img/packages_vs_r_version.jpg)

[source: Andrie de Vries](http://blog.revolutionanalytics.com/2016/04/cran-package-growth.html)

## Pipeline goal

[David Robinson](http://varianceexplained.org/) summarized the goal on his laptop

<img src="img/drob_r_pipeline_600.jpg">

## Period of much suckiness

```{r, echo=FALSE}
#devtools::install_github("ijlyttle/vembedr")
library("vembedr")
suppressPackageStartupMessages(library("dplyr"))
embed_youtube("8SGif63VW6E", query = list(start = secs("4m12s")))
```

## Period of much suckiness

> Whenever you’re learning a new tool, for a long time you’re going to suck...</br>
> But the good news is that it's typical, that’s something that happens to everyone, and it’s only temporary.</br>
> -- <cite>[Hadley Wickham][1]</cite>

[1]:https://youtu.be/8SGif63VW6E?t=4m12s

# Rstudio | Integrated Development Editor

## Layout, 4 panels

<img src="img/rstudio_layout_850.png">

## Features

- Package management
- Console to run R, with syntax highligther
- Editor to work with scripts / markdown
- autocompletion using TAB
- Cheatsheets
- Keyboard shortcuts

# Chaining

## The pipe operator %>%

[magrittr by Stefan Milton Bache](https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html)

Compare
```{r}
set.seed(124)
x <- rnorm(10)
mean(x)
round(mean(x), 3)
```

with
```{r}
set.seed(124)
rnorm(10) %>% mean %>% round(3)
```

Easy to read, natural from left to right.

Even better with **one** instruction per line and **indentation**
```{r}
set.seed(124)
rnorm(10) %>%
  mean %>%
  round(3)
```

# tidyr


## Concept | Definitions

- **Variable**: A quantity, quality, or property that you can measure.
- **Observation**: A set of values that display the relationship between variables.
  + To be an observation, values need to be measured under similar conditions, usually measured on the same observational unit at the same time.
- **Value**: The state of a variable that you observe when you measure it.

[source: Garret Grolemund](http://garrettgman.github.io/tidying/)

## Concept | Rules

1. Each variable is in its own column
2. Each observation is in its own row
3. Each value is in its own cell

![](img/tidy-1.png)

## Long / wide format

The wide format is generally untidy _but_ found in the majority of datasets

`tidyr` convert from one to another

Wide > Long
![](img/tidy-gather.png)
Long > Wide 
![](img/tidy-spread.png)


## Demo with iris

```{r}
head(iris, 3)
```

gather

```{r}
library("tidyr")
iris_melt <- iris %>%
  tibble::rownames_to_column() %>%
  dplyr::tbl_df() %>%
  gather(flower, measure, contains("al"))
iris_melt
```

##

spread

```{r}
iris_melt %>%
  spread(flower, measure)
```


## Reading data




```{r}
library("readr")
df <- read_tsv("women.tsv", col_names = TRUE)
df
```

## Reading data 2/3


Using `Rstudio`, right bottom panel. Select the **folder**

<img src="img/rstudio_explorer.png">

## Reading data 2/3

When the **folder** is selected and its content displayed, tell `R` to use this location (alternative to `setwd(/path/to/location)`). Press the `More` menu and click on

`Set As Working Directory`

<img src="img/rstudio_setwd.png">


## Reading data 3/3


Using `Rstudio`, right top panel. Select directly your **file**

<img src="img/rstudio_import.png">




# Plotting | ggplot2


## Why tidy is useful?

```{r}
library("tidyr")
library("ggplot2")
iris %>%
  gather(flower, measure, 1:4) %>%
  ggplot()+
  geom_boxplot(aes(x = Species, y = measure, fill = flower))
```

## Barplots

```{r, out.width='450px', out.height='450px'}
iris_melt %>%
  ggplot()+
  geom_bar(aes(x = Species, y = measure, fill = flower), stat = "identity")
```

[overview](http://rvisualization.com/ggplot2-overview-2/)

## Recommended reading

Excellent ressource about `R` (in French) by [Ewen Gallic](http://egallic.fr/Enseignement/R/m1_stat_eco_logiciel_R.pdf)

## Acknowledgments

Hadley
Ewen
Simon
David 
